define("kg/favorite/6.0.1/index",["dom","event","ua","kg/overlay/6.1.3/index","util","kg/favorite/6.0.1/index.css"],function(o,i,e){var a,t=o("dom"),n=o("event"),r=o("ua"),l=o("kg/overlay/6.1.3/index"),d=o("util");o("kg/favorite/6.0.1/index.css");a=function(o){"use strict";function i(o){o||(o={});var i=this;i.config=w.merge({hook:".J_TDialogTrigger",closeClass:"J_Del",showEvent:!0,hideEvent:!0,url:"",callback:null},o),o.url&&(i.useUserUrl=!0),i._init(i.config),window.favoriteCallBackFromIframe||(window.favoriteCallBackFromIframe=function(o){i.config.callback&&i.config.callback(o);try{!c.ie&&o&&w.later(function(){document.domain=window.top.favToolsFprBaseDomain},1e3)}catch(e){}})}var e=t,a=n,c=r,s=l,p=KISSY,w=d;return window.favToolsFprBaseDomain=document.domain,window.ua&&window.UA_Opt&&window.UA_Opt.reload||(window.ua||(window.ua=""),window.temp_ua||(window.temp_ua=""),window.UA_Opt||(window.UA_Opt=new Object),UA_Opt.isSendError=1,UA_Opt.LogVal="ua",UA_Opt.SendMethod=8,UA_Opt.MaxKSLog=10,UA_Opt.MaxMCLog=10,UA_Opt.MaxMPLog=10,UA_Opt.MPInterval=50,UA_Opt.MaxFocusLog=10,UA_Opt.MaxGPLog=10,UA_Opt.MaxTcLog=10,UA_Opt.Flag=97422,p.getScript("//uaction.alicdn.com/js/uab.js",{success:function(){window.temp_ua=window.ua,UA_Opt.Token=(new Date).getTime()+":"+Math.random(),UA_Opt.reload&&UA_Opt.reload()}})),w.augment(i,{_init:function(){var o=this;window.favoriteHasInitOverlay||o._initOverlay(),o._bindEvent()},_bindEvent:function(){var o=this;if(o.config.showEvent){a.delegate(document,"click",o.config.hook,function(i){i.halt(),window.thisFavoriteBtn=i.currentTarget,o.show(i.currentTarget)})}o.config.hideEvent&&a.delegate(document,"click","."+o.config.closeClass,function(i){i.halt(),o.hide()})},_initOverlay:function(){window.favoriteHasInitOverlay=!0,window.favoritePopup2014=new s({prefixCls:"favorate-",width:440,height:260,closable:!1,elStyle:{position:6==c.ie?"absolute":"fixed"},effect:{effect:"fade",duration:.5}}),window.favoritePopup2014.set("align",{points:["cc","cc"]}),e.attr(".favorate-overlay","id","popupPanel"),6==c.ie&&e.remove(e.get("iframe",e.get("#popupPanel")))},show:function(o){var i=this;window.thisFavoriteBtn=o,window.temp_ua=window.ua,UA_Opt.Token=(new Date).getTime()+":"+Math.random(),UA_Opt.reload&&UA_Opt.reload();var a=location.host,t=/net/,n=/tmall/,r=/tmall.hk/,l=/alitrip/,d=t.test(a),c=n.test(a),s=r.test(a),p=l.test(a),w=!d&&".com"||".net";i.appCode="",s?(document.domain="tmall.hk",i.appCode="&isTmall=2"):c?(document.domain="tmall"+w,i.appCode="&isTmall=1"):p?(document.domain="alitrip"+w,i.appCode="&isAlitrip=1"):document.domain="taobao"+w,i.useUserUrl||(i.config.url=e.attr(o,"href"));var f=0;if(window.g_config&&window.g_config.vdata&&window.g_config.vdata.viewer&&window.g_config.vdata.viewer.id&&(f=parseInt(window.g_config.vdata.viewer.id)),i.config.url.split("itemtype=1")[1]){window.favoritePopup2014.set("width",590),i.config.url=i.config.url.replace("popup/add_collection.htm","add_collection_like.htm");var u='<iframe src="'+i.config.url+"&ua="+encodeURIComponent(window.temp_ua)+i.appCode+"&t="+Math.random()+'" width="590px" height="260px" name="popupIframe" frameborder="0" scrolling="no"></iframe><a class="'+i.config.closeClass+' close-btn" href="#">X</a><div class="tb-canvas"></div>'}else{window.favoritePopup2014.set("width",440);var u='<iframe src="'+i.config.url+"&ua="+encodeURIComponent(window.temp_ua)+i.appCode+"&t="+Math.random()+'" width="440px" height="260px" name="popupIframe" frameborder="0" scrolling="no"></iframe><a class="'+i.config.closeClass+' close-btn" href="#">X</a><div class="tb-canvas"></div>'}window.favoritePopup2014.set("content",u),window.favoritePopup2014.show(),e.css(".favorate-overlay","display","block")},hide:function(){window.favoritePopup2014.hide(),window.favoritePopup2014.set("content","")}}),o=i}(),e.exports=a});define("kg/mini-login/6.3.7/index",["node","dom","event","cookie","util","ua","io"],function(i,t,e){var n,o=i("node"),s=i("dom"),l=i("event"),r=i("cookie"),c=i("util"),a=i("ua"),h=i("io");n=function(i){"use strict";function t(i){return this instanceof t?(this.cfg=g.merge(B,i||{}),this.guid=g.guid(),this.type=this.cfg.type,this.sub=this.cfg.sub,this.zindex=this.cfg.zindex,this.checkapi=2===this.cfg.checkapi?2:1,this.cfg.checkPath&&(this.checkPath=this.cfg.checkPath),this.cfg.guid=this.guid,this.cfg.ifrwidth=this.cfg.width-70,this.cfg.ifrheight=this.cfg.height-50,this.cfg.url=T,this.cfg.zindex=this.zindex,void this._init()):new t(i)}var e=o,n=s,d=l,f=r,g=c,u=a,p=h,m="https:"===location.protocol?"https:":"http:",b=g.unparam(location.search.slice(1))._login_daily_,_=k?"//g-assets.daily.taobao.net/":"//g.alicdn.com/",k=b||-1!==location.host.indexOf(".daily."),w=6===u.ie,x=!1;try{x=!!window.navigator.userAgent.match(/WindVane/i)}catch(v){}var y="1.4.6",C=k?"daily.taobao.net":"taobao.com",H=m+"//buy."+C+"/auction/buy.htm?from=tbcminilogin?_minilogin_t_={t}",z=m+"//member1."+C+"/member/info/login_status.do?_minilogin_t_={t}",I=m+"//www.taobao.com/go/act/loginsuccess/taobao.php",T="https://login."+C+"/member/login.jhtml?style=mini&newMini=true&is_ignore=false&redirect_url="+window.encodeURIComponent(I),j="https://login."+C+"/member/login.jhtml?redirect_url="+window.encodeURIComponent(location.href),M="http://login.m.taobao.com/login.htm?tpl_redirect_url="+encodeURIComponent(location.href),S=".#{prefixCls}mini-login{display:none;width:#{width}px;height:#{height}px;opacity:1;color:#404040;position:fixed;_position:absolute;z-index:#{zindex};}.#{prefixCls}mnl-bg{position:absolute;z-index:0;width:100%;height:100%;border:5px solid #999;left:-5px;top:-5px;opacity:0.8;}.#{prefixCls}mnl-box{position:relative;z-index:1;background:#fff;}.#{prefixCls}mnl-hd{height:34px;line-height:34px;padding-left:14px;font-family:Arial,Helvetica,sans-serif;font-weight:700;font-size:14px;margin-bottom:15px;border-bottom:1px solid #EAEAEA;background-color:#f2f2f2;}.#{prefixCls}mnl-ifr{display:block;width:#{ifrwidth}px;height:#{ifrheight}px;margin:0 auto;}.#{prefixCls}mnl-ft{background-color:#F5F5F5;}.#{prefixCls}mnl-close{display:block;width:24px;height:24px;text-align:center;line-height:24px;color:#999;font-family:Tahoma,sans;font-size:22px;position:absolute;text-decoration:none;top:5px;right:5px;opacity:0.8}.#{prefixCls}mnl-close:hover{opacity:1;border-radius:12px;background:#FFF;text-decoration:none;}",A='<div id="J_MiniLogin_{guid}" class="{prefixCls}mini-login J_TbMiniLogin"><div class="{prefixCls}mnl-bg"></div><div class="{prefixCls}mnl-box"><div class="{prefixCls}mnl-hd">{title}</div><div class="{prefixCls}mnl-bd"><iframe class="{prefixCls}mnl-ifr" scrolling="no" frameborder="no" id="J_MiniLoginIfr_{guid}" src="{url}"></iframe></div><div class="{prefixCls}mnl-ft"><a class="{prefixCls}mnl-close" id="J_MiniLoginClose_{guid}" target="_self" title="\u5173\u95ed\u6b64\u7a97\u53e3" href="javascript:void(0)">\xd7</a></div></div></div>',E=window.goldlog||{record:function(){}};E.record("/minilogin.10.1","","","H46866756");var L=window.g_config?g_config.loginCfg:{},B=g.merge({width:320,height:418,title:"\u8d26\u6237\u767b\u5f55",type:"m",sub:0,zindex:1e8},L||{}),J=[];return g.augment(t,d.Target,{_init:function(){try{this.nick=TB.Global.util.getNick()}catch(i){}E.record("/minilogin.10.2","","","H46866778")},_create:function(){var i=g.substitute(S,this.cfg,/#\{([^{}]+)\}/g),t=g.substitute(A,this.cfg);try{n.addStyleSheet(i)}catch(o){}this.el=e.one(n.create(t)),n.append(this.el,document.body),this.ifr=e.one("#J_MiniLoginIfr_"+this.guid),this._bind()},_bind:function(){var i=this;e.all("#J_MiniLoginClose_"+this.guid).on("click",function(t){t.halt(),i.hide(!1)}),this.ifr.on("load",function(t){return"about:blank"!==i.ifr.attr("src")?i.ifr.data("inited")?0===i.ifr.attr("src").indexOf(I)?void i._successHandle():0===i.ifr.attr("src").indexOf(T)?void i._checkAndShow(!0):void 0:void i.ifr.data("inited",1):void 0})},_pos:function(){var i,t,e=this.cfg.position;g.isObject(e)?(i=e.left||0,t=e.top||0):(i=parseInt(n.viewportWidth()/2,10)-parseInt(this.el[0].offsetWidth/2,10)+"px",t=(w?n.scrollTop():0)+parseInt(n.viewportHeight()/2,10)-parseInt(this.el[0].offsetHeight/2,10)+"px"),this.el.css({top:t,left:i})},_errorHandle:function(){window.top.location.href=x?M:j,E.record("/minilogin.10.11","","","H46896547")},_successHandle:function(i){var t=this;this.callbacked||(this.callbacked=!0,this.hide(!0),this.fire("login",{showed:!i}),g.each(J,function(i){i.fire("anylogin"),i.guid!=t.guid&&i.fire("otherlogin")}),this.callback&&this.callback(),this.callback=null,this._refreshGlobal(),E.record("/minilogin.10.10","","","H46896546"))},_refreshGlobal:function(){try{var i=TB.Global.util.getNick();if(i===this.nick)return;TB.Global.reload(),this.nick=i}catch(t){}},_localCheck:function(i){var t=f.get("_l_g_"),e=f.get("lgc"),n=f.get("tracknick");return"l"===this.type?void i(!!e):(i(null,t&&n),void E.record("/minilogin.10.6","","","H46866782"))},_asyncCheck:function(i){var t=this;if(t.checkPath)p({url:t.checkPath,type:"get",dataType:"json",timeout:5,data:{t:g.now()},error:function(i,e,n){t.fire("error",{status:e})},complete:function(t){return t&&g.isObject(t)?void(t.success&&t.login?i(null,!0):i(null,!1)):void i(new Error("checkPath error"))}});else{var e=1===this.checkapi?H:z;e=g.substitute(e,{t:g.now()}),1===this.checkapi?p.getScript(e,function(){return window.loginIndicator&&g.isObject(window.loginIndicator)?void(window.loginIndicator.hasLoggedIn?i(null,!0):i(null,!1)):(i(new Error("ErrCheckByBuy")),void E.record("/minilogin.10.9","","","H46866785"))}):p({url:e,type:"get",dataType:"jsonp",timeout:5,complete:function(e){return e&&g.isObject(e)?void(e.ma?i(!0):t.sub&&e.sa?i(null,!0):i(null,!1)):(i(new Error("ErrCheckByMember1")),void E.record("/minilogin.10.8","","","H46866784"))}})}E.record("/minilogin.10.7","","","H46866783")},check:function(i){"l"===this.type?this._localCheck(i):this._asyncCheck(i),E.record("/minilogin.10.5","","","H46866781")},_windVaneShow:function(){var i=this;p.getScript(_+"mtb/lib-windvane/"+y+"/windvane.js",function(){try{WindVane.call("TBHDCommon","login",{},function(t){i._successHandle()},function(t){i._errorHandle()})}catch(t){i._errorHandle()}})},_show:function(){return x?void this._windVaneShow():(this.el||this._create(),this.ifr.attr("src",T),e.all(".J_TbMiniLogin").hide(),this.el.show(),this._pos(),this.showed=!0,void e.one(window).on(w?"scroll resize":"resize",this._pos,this))},_checkAndShow:function(i){var t=this;this.check(function(e,n){if(e)return void t._errorHandle();if(n===!0)t._successHandle(i?!1:!0);else{if(t.ifr&&1===t.ifr.data("inited"))return;t._show()}})},show:function(i){this.callback=i,this._checkAndShow(),E.record("/minilogin.10.3","","","H46866779")},hide:function(i){this.callbacked=!1,E.record("/minilogin.10.4","","","H46866780"),this.el&&this.showed&&(this.el.hide(),this.showed=!1,this.callback=null,this.ifr.attr("src","about:blank"),this.ifr.data("inited",0),i?this.fire("hide"):this.fire("close"),e.one(window).detach(w?"scroll resize":"resize",this._pos,this))}}),i=t}(),e.exports=n});